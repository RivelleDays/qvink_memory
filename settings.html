<div id="qvink_memory_settings">
    <div class="inline-drawer">

        <div class="inline-drawer-toggle inline-drawer-header">
            <div class="flex-container alignitemscenter margin0">
                <b>Qvink Memory</b>
                <i id="popout_button" class="fa-solid fa-window-restore menu_button margin0"></i>
            </div>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>

        <div class="inline-drawer-content">
            <div id="drawer_content">
                <span class="flex1" >Current Memory:</span>
                <textarea id="current_memory" class="text_pole textarea_compact" rows="6" placeholder="Current memory injection will display here" readonly></textarea>

                <div class="flex-container justifyspacebetween alignitemscenter">
                    <div id="rerun_memory" class="menu_button flex1 margin0" title="Re-summarize all memories using current settings.">
                        <span>Rerun Memories</span>
                    </div>
                    <div id="refresh_memory" class="menu_button flex1 margin0" title="Refresh memory from current state (just in case)">
                        <span>Refresh</span>
                    </div>
                </div>

                <div class="main_settings">
                    <label for="enabled" title="Whether the extension is enabled" class="checkbox_label">
                        <input id="enabled" type="checkbox" />
                        <span>Enabled</span>
                    </label>
                    <label for="block_chat" title="Block input while summarizing" class="checkbox_label">
                        <input id="block_chat" type="checkbox" />
                        <span>Block Chat</span>
                    </label>
                </div>

                <label for="prompt" class="title_restorable">
                    <span>Summary Prompt</span>
                    <div id="prompt_restore" title="Restore default prompt" class="right_menu_button">
                        <div class="fa-solid fa-clock-rotate-left"></div>
                    </div>
                </label>
                <textarea id="prompt" class="text_pole textarea_compact" rows="6" placeholder="The prompt for generating summaries of individual messages"></textarea>

                <label for="include_world_info" title="Include World Info as context when summarizing?" class="checkbox_label">
                    <input id="include_world_info" type="checkbox" />
                    <span>Include World Info</span>
                </label>

                <label for="include_user_messages" title="Whether to summarize user messages" class="checkbox_label">
                    <input id="include_user_messages" type="checkbox" />
                    <span>Include User Messages</span>
                </label>

                <label for="include_names" title="Whether to include the name of the sender in the summary prompt." class="checkbox_label">
                    <input id="include_names" type="checkbox" />
                    <span>Include Names</span>
                </label>

                <label for="message_length_threshold" title="The minimum token length a message has to be in order to get summarized.">
                    <input id="message_length_threshold" class="text_pole widthUnset" type="number" min="0" max="999" />
                    <span>Message Length Threshold</span>
                </label>

                <label for="summary_maximum_length" title="The maximum token length a summary is allowed to be before cutting it off.">
                    <input id="summary_maximum_length" class="text_pole widthUnset" type="number" min="0" max="999" />
                    <span>Summary Max Length</span>
                </label>

                <div class="template">
                    <label for="template">Injection Template</label>
                    <textarea id="template" class="text_pole textarea_compact" rows="2"  placeholder="Use &lcub;&lcub;long_memory&rcub;&rcub; and &lcub;&lcub;short_memory&rcub;&rcub; "></textarea>
                </div>


                <!-- Long-term memory -->
                <label for="long_term_context_limit" title="The max proportion of the context that long-term memory can take up.">
                    <span>Long-Term Context Proportion</span>
                    <input id="long_term_context_limit" class="text_pole widthUnset" type="number" min="0" max="999" />
                </label>
                <label class="checkbox_label" for="long_term_scan" title="Include long-term memory in the World Info Scan">
                    <input id="long_term_scan" type="checkbox" />
                    <span>Include in World Info Scanning</span>
                </label>
                <label>Long-Term Memory Injection Position</label>
                <div class="radio_group">
                    <label>
                        <input type="radio" name="long_term_position" value="-1" />
                        <span>None (not injected)</span>
                        <i class="fa-solid fa-info-circle" title="Not injected. You can still access it via the &lcub;&lcub;long_memory&rcub;&rcub; macro."></i>
                    </label>
                    <label>
                        <input type="radio" name="long_term_position" value="2" />
                        <span>Before Main Prompt / Story String</span>
                    </label>
                    <label>
                        <input type="radio" name="long_term_position" value="0" />
                        <span >After Main Prompt / Story String</span>
                    </label>
                    <label class="flex-container alignItemsCenter" title="How many messages before the current end of the chat.">
                        <input type="radio" name="long_term_position" value="1" />
                        <span>In-chat at depth</span>
                        <input id="long_term_depth" class="text_pole widthUnset" type="number" min="0" max="999" />
                        <span>as</span>
                        <select id="long_term_role" class="text_pole widthNatural">
                            <option value="0">System</option>
                            <option value="1">User</option>
                            <option value="2">Assistant</option>
                        </select>
                    </label>
                </div>

                <!-- Short-term memory -->
                <label for="short_term_context_limit" title="The max proportion of the context that short-term memory can take up.">
                    <span>Short-Term Context Proportion</span>
                    <input id="short_term_context_limit" class="text_pole widthUnset" type="number" min="0" max="999" />
                </label>
                <label class="checkbox_label" for="short_term_scan" title="Include short-term memory in the World Info Scan">
                    <input id="short_term_scan" type="checkbox" />
                    <span>Include in World Info Scanning</span>
                </label>
                <label>Short-Term Memory Injection Position</label>
                <div class="radio_group">
                    <label>
                        <input type="radio" name="short_term_position" value="-1" />
                        <span>None (not injected)</span>
                        <i class="fa-solid fa-info-circle" title="Not injected. You can still access it via the &lcub;&lcub;short_memory&rcub;&rcub; macro."></i>
                    </label>
                    <label>
                        <input type="radio" name="short_term_position" value="2" />
                        <span>Before Main Prompt / Story String</span>
                    </label>
                    <label>
                        <input type="radio" name="short_term_position" value="0" />
                        <span >After Main Prompt / Story String</span>
                    </label>
                    <label class="flex-container alignItemsCenter" title="How many messages before the current end of the chat.">
                        <input type="radio" name="short_term_position" value="1" />
                        <span>In-chat at depth</span>
                        <input id="short_term_depth" class="text_pole widthUnset" type="number" min="0" max="999" />
                        <span>as</span>
                        <select id="short_term_role" class="text_pole widthNatural">
                            <option value="0">System</option>
                            <option value="1">User</option>
                            <option value="2">Assistant</option>
                        </select>
                    </label>
                </div>

            </div>
        </div>
    </div>
</div>
